"use strict";window.CoreLibrary=function(){function t(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e}function e(t){return t.json()}return rivets.formatters["==="]=function(t,e){return t===e},rivets.formatters["=="]=function(t,e){return t==e},rivets.formatters[">="]=function(t,e){return t>=e},rivets.formatters[">"]=function(t,e){return t>e},rivets.formatters["<="]=function(t,e){return e>=t},rivets.formatters["<"]=function(t,e){return e>t},rivets.formatters["!="]=function(t,e){return t!=e},rivets.formatters["!=="]=function(t,e){return t!==e},rivets.formatters.and=function(t,e){return t&&e},rivets.formatters.or=function(t,e){return t||e},rivets.formatters.not=function(t){return!t},rivets.formatters["-"]=function(t,e){return t-e},rivets.formatters["+"]=function(t,e){return t+e},rivets.formatters["*"]=function(t,e){return t*e},rivets.formatters["/"]=function(t,e){return t/e},rivets.formatters["?"]=function(t,e){return t?t:e},rivets.formatters.array_at=function(t,e,i){return null==t?[]:t[e][i]},rivets.formatters.property_list=function(t){return function(){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push({key:i,value:t[i]});return e}()},rivets.binders["style-*"]=function(t,e){t.style.setProperty(this.args[0],e)},rivets.binders.cloak={priority:-1e3,bind:function(t){t.style.opacity=1}},rivets.binders["anim-stagger"]=function(t,e){if(0>e)return!1;var i=70;t.classList.remove("anim-stagger"),t.classList.add("anim-stagger"),setTimeout(function(){t.classList.add("anim-enter-active"),setTimeout(function(){t.classList.remove("anim-stagger"),t.classList.remove("anim-enter-active")},200)},i*e)},rivets.binders["custom-class"]=function(t,e){var i=t.getAttribute("rv-toggle-class");e===!0?t.classList.add(i):t.classList.remove(i)},sightglass.adapters=rivets.adapters,sightglass.root=".",{expectedApiVersion:"1.0.0.10",development:!1,utilModule:null,widgetModule:null,offeringModule:null,statisticsModule:null,apiReady:!1,config:{apiBaseUrl:"",auth:!1,channelId:1,currency:"",customer:"",device:"desktop",locale:"en_GB",market:"GB",oddsFormat:"decimal",offering:"",routeRoot:"",streamingAllowedForPlayer:!0,client_id:2,version:"v2"},height:450,pageInfo:{leaguePaths:[],pageParam:"",pageTrackingPath:"",pageType:""},apiVersions:{client:"",libs:"",wapi:""},args:{},init:function(i){return new Promise(function(r,n){window.KambiWidget?window.self===window.top?fetch("mockSetupData.json").then(t).then(e).then(function(t){this.applySetupData(t,i),null!=this.translationModule?this.translationModule.fetchTranslations(t.clientConfig.locale).then(function(){r(t.arguments)}.bind(this)):r(t.arguments)}.bind(this))["catch"](function(t){n()}):(window.KambiWidget.apiReady=function(t){this.widgetModule.api=t,t.VERSION!==this.expectedApiVersion,this.requestSetup(function(t){this.applySetupData(t,i),this.widgetModule.requestBetslipOutcomes(),this.widgetModule.requestOddsFormat(),null!=this.translationModule?this.translationModule.fetchTranslations(t.clientConfig.locale).then(function(){r(t.arguments)}.bind(this)):r(t.arguments)}.bind(this))}.bind(this),window.KambiWidget.receiveResponse=function(t){this.widgetModule.handleResponse(t)}.bind(this)):n()}.bind(this))},applySetupData:function(t,e){this.setConfig(t.clientConfig),this.setPageInfo(t.pageInfo),this.setVersions(t.versions),e===!0&&this.setHeight(t.height),this.apiReady=!0},setConfig:function(t){for(var e in t)t.hasOwnProperty(e)&&this.config.hasOwnProperty(e)&&(this.config[e]=t[e]);null==this.config.routeRoot?this.config.routeRoot="":this.config.routeRoot.length>0&&"/"!==this.config.routeRoot.slice(-1)&&(this.config.routeRoot+="/")},setPageInfo:function(t){"filter"===t.pageType&&"/"!==t.pageParam.substr(-1)&&(t.pageParam+="/"),this.pageInfo=t},setVersions:function(t){for(var e in t)t.hasOwnProperty(e)&&this.apiVersions.hasOwnProperty(e)&&(this.apiVersions[e]=t[e])},setArgs:function(t){this.args=t},requestSetup:function(t){this.widgetModule.requestSetup(t)},receiveRespone:function(t){},setOddsFormat:function(t){this.config.oddsFormat=t},setHeight:function(t){this.height=t,this.widgetModule.setHeight(t)},getData:function(i){return fetch(i).then(t).then(e)["catch"](function(t){throw t})},getFile:function(e){return fetch(e).then(t)["catch"](function(t){throw t})}}}(),CoreLibrary.offeringModule=function(){return{getGroupEvents:function(t){var e="/event/group/"+t+".json";return this.doRequest(e)},getEventsByFilter:function(t,e){var i="/listView/"+t;return this.doRequest(i,e,"v3")},getLiveEvents:function(){var t="/event/live/open.json";return this.doRequest(t)},getLiveEventsByFilter:function(t){var e=this;t=t.replace(/\/$/,"");var i=t.split("/");i=i.slice(0,3);var r="/listView/all/all/all/all/in-play/",n=new Promise(function(t,n){e.doRequest(r,null,"v3").then(function(e){for(var r={events:[]},n=0,s=e.events.length;s>n;++n){var a=0,o=e.events[n].event.path.length,u=!0;for(o>i.length&&(o=i.length);o>a;++a)"all"!==i[a]&&e.events[n].event.path[a].termKey!==i[a]&&(u=!1);u&&r.events.push(e.events[n])}t(r)})});return n},doRequest:function(t,e,i){if(null!=CoreLibrary.config.offering){var r=CoreLibrary.config.apiBaseUrl.replace("{apiVersion}",null!=i?i:CoreLibrary.config.version),n=r+CoreLibrary.config.offering+t,s=e||{},a={lang:s.locale||CoreLibrary.config.locale,market:s.market||CoreLibrary.config.market,client_id:s.client_id||CoreLibrary.config.client_id,include:s.include||"",betOffers:s.betOffers||"COMBINED",categoryGroup:s.categoryGroup||"COMBINED",displayDefault:s.displayDefault||!0};return n+="?"+Object.keys(a).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(a[t])}).join("&"),CoreLibrary.getData(n)}}}}(),CoreLibrary.statisticsModule=function(){return{config:{baseApiUrl:"https://api.kambi.com/statistics/api/"},getStatistics:function(t,e){return e=e.match(/[^?]*/)[0],"/"===e[e.length-1]&&(e=e.slice(0,-1)),CoreLibrary.getData(this.config.baseApiUrl+CoreLibrary.config.offering+"/"+t+"/"+e+".json")}}}(),window.CoreLibrary.translationModule=function(){var t={i18nStrings:{},fetchTranslations:function(e){null==e&&(e="en_GB");var i=this,r="i18n/";return CoreLibrary.development===!0&&(r="transpiled/i18n/"),new Promise(function(n,s){window.CoreLibrary.getData(r+e+".json").then(function(e){t.i18nStrings=e,n()})["catch"](function(t){"en_GB"!==e?i.fetchTranslations("en_GB").then(n):n()})})},getTranslation:function(t){return null!=this.i18nStrings[t]?this.i18nStrings[t]:t}};return rivets.formatters.translate=function(e){return t.getTranslation(e)},t}(),window.CoreLibrary.utilModule=function(){var t={diffArray:function(t,e){for(var i={},r=[],n=e.length;n--;)i[e[n]]=null;for(var n=t.length;n--;)i.hasOwnProperty(t[n])||r.push(t[n]);return r},getOutcomeLabel:function(t,e){switch(t.type){case"OT_ONE":return e.homeName;case"OT_CROSS":return CoreLibrary.translationModule.getTranslation("draw");case"OT_TWO":return e.awayName;default:return t.label}}};return t}(),CoreLibrary.widgetModule=function(){var t=Stapes.subclass();return{api:{requestSetup:function(){},request:function(){},set:function(){},remove:function(){},createUrl:function(){}},events:new t,betslipIds:[],handleResponse:function(t){switch(t.type){case this.api.WIDGET_HEIGHT:this.events.emit("WIDGET:HEIGHT",t.data);break;case this.api.BETSLIP_OUTCOMES:for(var e=0,i=t.data.outcomes.length,r=[];i>e;++e)r.push(t.data.outcomes[e].id);var n=CoreLibrary.utilModule.diffArray(this.betslipIds,r),s=CoreLibrary.utilModule.diffArray(r,this.betslipIds);for(this.betslipIds=r,e=0,i=n.length;i>e;++e)this.events.emit("OUTCOME:REMOVED:"+n[e]);for(e=0,i=s.length;i>e;++e)this.events.emit("OUTCOME:ADDED:"+s[e]);this.events.emit("OUTCOMES:UPDATE",t.data);break;case this.api.WIDGET_ARGS:CoreLibrary.setArgs(t.data),this.events.emit("WIDGET:ARGS",t.data);break;case this.api.PAGE_INFO:CoreLibrary.setPageInfo(t.data),this.events.emit("PAGE:INFO",t.data);break;case this.api.CLIENT_ODDS_FORMAT:CoreLibrary.setOddsFormat(t.data),this.events.emit("ODDS:FORMAT",t.data);break;case this.api.CLIENT_CONFIG:CoreLibrary.setConfig(t.data),this.events.emit("CLIENT:CONFIG",t.data);break;case this.api.USER_LOGGED_IN:this.events.emit("USER:LOGGED_IN",t.data);break;case"Setup":this.events.emit("Setup response",t.data)}},createUrl:function(t,e){return this.api.createUrl(t,e)},getPageType:function(){if(!CoreLibrary.pageInfo.pageType)return"";var t=CoreLibrary.pageInfo.pageType;switch(t){case"event":return"";case"event-live":return"live/"}},requestSetup:function(t){this.api.requestSetup(t)},requestWidgetHeight:function(){this.api.request(this.api.WIDGET_HEIGHT)},setWidgetHeight:function(t){this.api.set(this.api.WIDGET_HEIGHT,t)},enableWidgetTransition:function(t){t?this.api.set(this.api.WIDGET_ENABLE_TRANSITION):this.api.set(this.api.WIDGET_DISABLE_TRANSITION)},removeWidget:function(){this.api.remove()},navigateToLiveEvent:function(t){this.navigateClient("event/live/"+t)},navigateToEvent:function(t){this.navigateClient("event/"+t)},navigateToFilter:function(t){this.navigateClient(t)},navigateToLiveEvents:function(){this.navigateClient(["in-play"])},addOutcomeToBetslip:function(t,e,i,r){var n=[];Array.isArray(t)?n=t:n.push(t);var s={outcomes:n};null!=e&&(e.isArray()?s.stakes=e:s.stakes=[e]),s.couponType=1===n.length?this.api.BETSLIP_OUTCOMES_ARGS.TYPE_SINGLE:this.api.BETSLIP_OUTCOMES_ARGS.TYPE_COMBINATION,s.updateMode="replace"!==i?this.api.BETSLIP_OUTCOMES_ARGS.UPDATE_APPEND:this.api.BETSLIP_OUTCOMES_ARGS.UPDATE_REPLACE,null!=r&&(s.source=r),this.api.set(this.api.BETSLIP_OUTCOMES,s)},removeOutcomeFromBetslip:function(t){var e=[];Array.isArray(t)?e=t:e.push(t),this.api.set(this.api.BETSLIP_OUTCOMES_REMOVE,{outcomes:e})},requestBetslipOutcomes:function(){this.api.request(this.api.BETSLIP_OUTCOMES)},requestPageInfo:function(){this.api.request(this.api.PAGE_INFO)},requestWidgetArgs:function(){this.api.request(this.api.WIDGET_ARGS)},requestClientConfig:function(){this.api.request(this.api.CLIENT_CONFIG)},requestOddsFormat:function(){this.api.request(this.api.CLIENT_ODDS_FORMAT)},requestOddsAsAmerican:function(t){return new Promise(function(e,i){this.api.requestOddsAsAmerican(t,function(t){e(t)})}.bind(this))},requestOddsAsFractional:function(t){return new Promise(function(e,i){this.api.requestOddsAsFractional(t,function(t){e(t)})})},navigateClient:function(t){if("string"==typeof t)this.api.navigateClient("#"+CoreLibrary.config.routeRoot+t);else if(t.isArray()){var e=this.api.createFilterUrl(t,CoreLibrary.config.routeRoot);this.api.navigateClient(e)}}}}(),function(){CoreLibrary.Component=Stapes.subclass({defaultArgs:{},htmlTemplate:null,htmlTemplateFile:null,constructor:function(t){var e=this;this.scope={},this.view=null,this.rootElement=null,null==t&&(t={});var i=["defaultArgs","rootElement"];if(i.forEach(function(i){"undefined"!=typeof t[i]&&(e[i]=t[i])}),"string"==typeof this.htmlTemplate&&"string"==typeof this.htmlTemplateFile)throw new Error("Widget can not have htmlTemplate and htmlTemplateFile set at the same time");if(null==this.rootElement)throw new Error("options.rootElement not set, please pass a HTMLElement or a CSS selector");this.scope.args=this.defaultArgs;var r;r="string"==typeof this.htmlTemplateFile?CoreLibrary.getFile(this.htmlTemplateFile).then(function(t){return t.text()}).then(function(t){return e.htmlTemplate=t,e.htmlTemplate}):new Promise(function(t){t()});var n;return n=CoreLibrary.apiReady===!0?new Promise(function(t,e){t()}):new Promise(function(t,i){CoreLibrary.init().then(function(i){Object.keys(i).forEach(function(t){e.scope.args[t]=i[t]});var r=CoreLibrary.widgetModule.api.VERSION;if(null==r)var r="1.0.0.10";e.scope.widgetCss="//c3-static.kambi.com/sb-mobileclient/widget-api/"+r+"/resources/css/"+CoreLibrary.config.customer+"/"+CoreLibrary.config.offering+"/widgets.css",t()})}),Promise.all([n,r]).then(function(){"string"==typeof e.rootElement&&(e.rootElement=document.querySelector(e.rootElement));for(var t=0;t<e.rootElement.attributes.length;++t){var i=e.rootElement.attributes[t];if(0===i.name.indexOf("data-")){var r=i.name.slice(5);e.scope[r]=i.value}}"string"==typeof e.htmlTemplate&&(e.rootElement.innerHTML=e.htmlTemplate),e.view=rivets.bind(e.rootElement,e.scope),e.init()})}})}(),function(){var t=function(t){var e=this;this.data=t,this.selected=!1,this.label="",this.coreLibraryConfig=CoreLibrary.config,null!=this.data.outcomeAttr&&(null!=this.data.eventAttr?this.label=CoreLibrary.utilModule.getOutcomeLabel(this.data.outcomeAttr,this.data.eventAttr):this.label=this.data.outcomeAttr.label,-1!==CoreLibrary.widgetModule.betslipIds.indexOf(this.data.outcomeAttr.id)&&(this.selected=!0),CoreLibrary.widgetModule.events.on("OUTCOME:ADDED:"+this.data.outcomeAttr.id,function(t,i){e.selected=!0}),CoreLibrary.widgetModule.events.on("OUTCOME:REMOVED:"+this.data.outcomeAttr.id,function(t,i){e.selected=!1})),this.toggleOutcome=function(t,e){e.selected===!1?CoreLibrary.widgetModule.addOutcomeToBetslip(e.data.outcomeAttr.id):CoreLibrary.widgetModule.removeOutcomeFromBetslip(e.data.outcomeAttr.id)},this.getOddsFormat=function(){switch(this.coreLibraryConfig.oddsFormat){case"fractional":return this.data.outcomeAttr.oddsFractional;case"american":return this.data.outcomeAttr.oddsAmerican;default:return this.data.outcomeAttr.odds/1e3}}};rivets.components["outcome-component"]={template:function(){return'<button rv-on-click="toggleOutcome" type="button" role="button" class="KambiWidget-outcome kw-link l-flex-1 l-ml-6" rv-custom-class="selected" rv-toggle-class="KambiWidget-outcome--selected" ><div class="KambiWidget-outcome__flexwrap"><div class="KambiWidget-outcome__label-wrapper"><span class="KambiWidget-outcome__label">{label}</span><span class="KambiWidget-outcome__line"></span></div><div class="KambiWidget-outcome__odds-wrapper"><span class="KambiWidget-outcome__odds" rv-text="getOddsFormat < data.outcomeAttr.odds coreLibraryConfig.oddsFormat"></span></div></div></button>'},initialize:function(e,i){return e.classList.add("l-flexbox"),e.classList.add("l-flex-1"),new t(i)}},rivets.components["outcome-component-no-label"]={template:function(){return'<button rv-on-click="toggleOutcome" rv-disabled="betOffer.suspended | == true"rv-custom-class="selected" rv-toggle-class="KambiWidget-outcome--selected" type="button" role="button" class="KambiWidget-outcome kw-link l-ml-6"><div class="l-flexbox l-pack-center"><div class="KambiWidget-outcome__odds-wrapper"><span class="KambiWidget-outcome__odds" rv-text="getOddsFormat < data.outcomeAttr.odds coreLibraryConfig.oddsFormat" ></span></div></div></button>'},initialize:function(e,i){return new t(i)}}}(),function(){CoreLibrary.PaginationComponent=CoreLibrary.Component.subclass({htmlTemplate:'<div class="kw-pagination l-flexbox l-pack-center l-align-center"><span rv-on-click="previousPage" rv-class-disabled="firstPage"class="kw-page-link kw-pagination-arrow"><i class="icon-angle-left"></i></span><span rv-each-page="pages" rv-on-click="page.clickEvent" rv-class-kw-active-page="page.selected"class="kw-page-link l-pack-center l-align-center" >{page.text}</span><span rv-on-click="nextPage" rv-class-disabled="lastPage"class="kw-page-link kw-pagination-arrow"><i class="icon-angle-right"></i></span></div>',constructor:function(t,e,i,r,n){CoreLibrary.Component.apply(this,[{rootElement:t}]),this.scopeKey=i,this.pageSize=r?r:3,this.maxVisiblePages=n?n:5,this.scope.currentPage=0,this.scope.firstPage=!0,this.scope.lastPage=!1,e["_"+i]=[],this.originalArray=e[i],this.currentPageArray=e["_"+i],sightglass(e,i,function(){this.originalArray=e[i],this.setCurrentPage(0),this.clearArray(),this.adaptArray()}.bind(this)),this.scope.nextPage=this.nextPage.bind(this),this.scope.previousPage=this.previousPage.bind(this),this.adaptArray()},clearArray:function(){this.currentPageArray.splice(0,this.currentPageArray.length)},getCurrentPage:function(){return this.scope.currentPage},setCurrentPage:function(t){if(t!==this.getCurrentPage()){if(0>t||t>=this.getNumberOfPages())throw new Error("Invalid page number");this.scope.currentPage=t,this.adaptArray()}},getNumberOfPages:function(){return Math.ceil(this.originalArray.length/this.pageSize)},nextPage:function(){return this.getCurrentPage()<this.getNumberOfPages()-1&&this.setCurrentPage(this.getCurrentPage()+1),this.getCurrentPage()},previousPage:function(){return this.getCurrentPage()>0&&this.setCurrentPage(this.getCurrentPage()-1),this.getCurrentPage()},adaptArray:function(){this.clearArray();var t=this.getCurrentPage()*this.pageSize,e=t+this.pageSize;e>=this.originalArray.length&&(e=this.originalArray.length);for(var i=t;e>i;++i)this.currentPageArray.push(this.originalArray[i]);this.scope.firstPage=0===this.getCurrentPage(),this.scope.lastPage=this.getCurrentPage()===this.getNumberOfPages()-1,this.render()},init:function(){this.render()},render:function(t){this.scope.pages=[];var e=this.getCurrentPage()-2;if(this.getCurrentPage()+2>=this.getNumberOfPages())var e=this.getNumberOfPages()-5;0>e&&(e=0);for(var i=e,r=0;i<this.getNumberOfPages()&&5>r;)this.scope.pages.push({text:i+1+"",number:i,selected:i===this.getCurrentPage(),clickEvent:this.setCurrentPage.bind(this,i)}),++i,++r}})}();